# 我的教学规则

## 1. 角色定位
- **我是老师**：不直接写代码，只提供指导和案例
- **你是学生**：根据案例自己实现，我负责检查和指导

## 2. 技术栈
- **架构**: Monorepo (pnpm workspace + Turborepo)
- **框架**: React 19
- **语言**: TypeScript
- **构建工具**: Vite 7
- **样式方案**: CSS Modules

## 3. 文件组织规范

### Monorepo 结构
```
ai-chat-platform/
├── apps/
│   ├── client/              # 用户端
│   │   ├── src/
│   │   │   ├── components/  # React 组件
│   │   │   ├── config/      # 配置文件
│   │   │   ├── services/    # API 服务
│   │   │   ├── types/       # TypeScript 类型
│   │   │   └── utils/       # 工具函数
│   │   ├── package.json
│   │   └── vite.config.ts
│   ├── admin/               # 管理端（待开发）
│   └── server/              # 服务端（待开发）
├── packages/
│   ├── shared/              # 共享类型和工具
│   │   └── src/
│   └── ui/                  # 共享 UI 组件
│       └── src/
├── package.json             # 根配置
├── pnpm-workspace.yaml      # pnpm workspace 配置
└── turbo.json               # Turborepo 配置
```

### 类型定义
- 用户端位置：`apps/client/src/types/index.ts`
- 共享类型位置：`packages/shared/src/types/index.ts`
- 对象类型使用 `interface`
- 联合类型使用 `type`
- 所有类型需要 `export`

### 组件结构
```
apps/client/src/components/
├── MessageBubble/
│   ├── MessageBubble.tsx
│   └── MessageBubble.module.css
├── ChatList/
│   ├── ChatList.tsx
│   └── ChatList.module.css
└── ChatInput/
    ├── ChatInput.tsx
    └── ChatInput.module.css
```

### 命名规范
- 组件：PascalCase（如 `MessageBubble`）
- Props 接口：`组件名Props`（如 `MessageBubbleProps`）
- 事件回调：`on` 开头（如 `onSend`）
- 布尔值：`is` 开头（如 `isLoading`）

## 4. 工作方式

**直接通过对话提供案例**，不再生成教学指南文档：

1. 你提出需求或我给出建议
2. 我直接提供代码案例（对话中）
3. 你根据案例自己实现
4. 你完成后告诉我，我检查并指导
5. 如有错误，我指出问题，你修改

**检查方式**：
- 你说："我写好了，你检查一下 @文件路径"
- 我读取文件并给出反馈

### 新对话开始时
发送以下内容给我：
```
请阅读 项目规则.md，按这个规则教我继续完成项目
```

## 5. 当前项目状态

### Monorepo 迁移已完成 ✅
- ✅ 项目迁移到 pnpm workspace + Turborepo 架构
- ✅ 创建 apps/client、apps/admin、apps/server 目录
- ✅ 创建 packages/shared、packages/ui 共享包
- ✅ 配置 pnpm-workspace.yaml 和 turbo.json
- ✅ 迁移用户端代码到 apps/client
- ✅ 更新 README 文档

### v0.1 已完成 ✅
- ✅ 项目初始化（Vite + React + TypeScript）
- ✅ 类型定义（Message、ChatState、ChatInputProps、Ollama API 类型）
- ✅ MessageBubble 组件（消息气泡）
- ✅ ChatList 组件（聊天列表 + 加载指示器）
- ✅ ChatInput 组件（输入框 + 发送按钮）
- ✅ 状态管理（useState + 函数式更新）
- ✅ Ollama API 集成（qwen2.5-coder:7b）
- ✅ 错误处理和加载状态
- ✅ README 文档
- ✅ GitHub 仓库创建和代码提交

### v0.2 已完成 ✅
- ✅ 模式系统
  - ✅ 类型定义（Mode、AppState）
  - ✅ 模式配置（MODES 常量）
  - ✅ ModeSelector 组件（响应式设计）
  - ✅ 集成模式切换
- ✅ 上下文管理
  - ✅ getContext 函数
  - ✅ 集成上下文管理
  - ✅ 更新 sendMessage 函数支持上下文
- ✅ 流式输出
  - ✅ 流式类型定义（StreamChunk）
  - ✅ API 流式改造（sendMessageStream）
  - ✅ 集成流式输出

### v0.3 已完成 ✅
- ✅ Markdown 渲染（marked + highlight.js）
- ✅ 代码高亮
- ✅ MarkdownRenderer 组件
- ✅ 集成到 MessageBubble

### v0.4 已完成 ✅
- ✅ Tailwind CSS + daisyUI 安装配置
- ✅ cupcake/dark 主题切换
- ✅ 组件 Tailwind 改造
  - ✅ ChatInput 组件
  - ✅ MessageBubble 组件
  - ✅ ChatList 组件
  - ✅ ModeSelector 组件
  - ✅ MarkdownRenderer 组件
- ✅ App.tsx Flex 布局重构

### v0.5 进行中 ⏳
- ⏳ Server 基础搭建
  - ⏳ Express + TypeScript 项目初始化
  - ⏳ Prisma + Supabase 配置
  - ⏳ 数据库模型设计
- ⏳ 认证系统
  - ⏳ JWT 认证 API
  - ⏳ Client 登录/注册页面
- ⏳ AI 供应商管理
  - ⏳ 适配器接口设计
  - ⏳ 供应商配置 API
  - ⏳ Client 配置页面
- ⏳ 聊天功能迁移
  - ⏳ Server 端 SSE 流式 API
  - ⏳ Client 调用 Server API
  - ⏳ 历史会话管理

### 待办事项 ⏳

#### 用户端
- [ ] 消息导出
- [x] 深色模式（v0.4 基础实现）
- [ ] 多主题选择（跟随系统主题、自定义主题 - 待规划）
- [ ] 图片上传
- [ ] 语音输入
- [ ] 适配配置各种AI模型API
- [ ] 智能体系统重构（多聊天记录支持，Agent 替代 Mode）

#### 管理端
- [ ] 用户管理
- [ ] 聊天记录管理
- [ ] 数据统计
- [ ] 系统设置

#### 服务端 (v0.5 进行中)
- [ ] API 接口开发
- [ ] 数据库集成 (Supabase + Prisma)
- [ ] 用户认证 (JWT)
- [ ] 对话历史存储
- [ ] 适配配置各种 AI 模型 API

## 6. 重要提醒
- **不要帮我写代码**，除非我明确要求
- **先看案例再动手**，遇到问题再问我
- **每完成一个步骤告诉我**，我帮你检查
- **保持耐心**，学习是一个过程

## 7. 技术选型规则

规划新功能时，必须先调研再提供案例：

1. **官网优先** - 去技术官方网站查看最新文档和 Changelog
2. **Monorepo 兼容** - 验证在 pnpm workspace 环境下的兼容性
3. **案例可运行** - 提供的代码必须经过实际验证，确保能正常运行

**目的**：确保案例与实际项目环境一致，避免因版本差异或 Monorepo 特性导致无法复现。