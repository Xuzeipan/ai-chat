# v0.5 规划 - AI Chat Platform 后端服务与多模型支持

## 功能需求

v0.5 将实现完整的后端服务和用户认证系统，支持多 AI 供应商配置。

### Server 端功能
- 用户注册/登录（JWT 认证）
- Supabase 数据库集成（Supabase Client）
- AI 供应商配置管理（用户各自的 API Key）
- 统一 AI API 适配器（支持 8+ 供应商）
- 聊天历史存储
- Token 使用统计

### Client 端功能
- 登录/注册页面
- JWT Token 管理
- AI 供应商配置页面
- 模型选择器
- 历史会话列表

## 技术选型

| 项目 | 选择 |
|------|------|
| 后端框架 | Express.js + TypeScript |
| 数据库 | Supabase (PostgreSQL) |
| 数据库连接 | Supabase Client |
| 认证 | JWT |
| AI 供应商 | OpenAI, Claude, Gemini, Kimi, Minimax, DeepSeek, ZhiPU GLM, Ollama |

## 实现步骤

### Phase 1: Server 基础搭建
1. [ ] **Server 项目初始化** - Express + TypeScript 项目搭建
2. [ ] **数据库配置** - Supabase Client 连接配置
3. [ ] **数据库模型** - 用户、供应商配置、会话、消息等表设计（在 Supabase Dashboard 创建）

### Phase 2: 认证系统
4. [ ] **认证 API 开发** - 注册/登录/获取用户信息
5. [ ] **Client 登录页面** - 登录/注册表单
6. [ ] **JWT 集成** - Token 管理和路由守卫

### Phase 3: AI 供应商管理
7. [ ] **供应商适配器** - 统一的 AI 适配器接口
8. [ ] **供应商配置 API** - 增删改查用户 API Key
9. [ ] **Client 供应商配置** - 设置页面表单

### Phase 4: 聊天功能迁移
10. [ ] **流式对话 API** - Server 端 SSE 流式响应
11. [ ] **Client 聊天改造** - 调用 Server API
12. [ ] **历史会话** - 会话列表和消息存储

## 技术要点

1. **API Key 加密存储** - 使用 AES 加密用户 API Key
2. **适配器模式** - 统一不同 AI 供应商的接口差异
3. **JWT 安全** - Access Token + Refresh Token 机制
4. **SSE 流式响应** - Server-Sent Events 实现流式输出
5. **Supabase 表关系** - 一对多关系（用户-会话-消息）

## 测试验证

- [ ] 用户可正常注册和登录
- [ ] 可配置多个 AI 供应商的 API Key
- [ ] 可选择不同供应商和模型进行对话
- [ ] 对话历史正确保存和展示
- [ ] Token 使用量被记录

## 学习收获

1. Express.js + TypeScript 后端开发
2. Supabase Client 和数据库设计
3. JWT 认证流程
4. 适配器设计模式
5. SSE 服务器推送技术
6. 多供应商 API 集成
