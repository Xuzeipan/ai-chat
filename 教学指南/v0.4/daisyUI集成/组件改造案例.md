# 组件改造案例 - ChatInput

以 ChatInput 组件为例，演示如何将 CSS Modules 改造为 Tailwind CSS + daisyUI。

## 改造前（CSS Modules 版本）

### ChatInput.tsx
```typescript
import { useState } from 'react';
import styles from './ChatInput.module.css';

interface ChatInputProps {
  onSend: (message: string) => void;
  isLoading?: boolean;
}

export default function ChatInput({ onSend, isLoading }: ChatInputProps) {
  const [input, setInput] = useState('');

  const handleSend = () => {
    if (!input.trim() || isLoading) return;
    onSend(input);
    setInput('');
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSend();
    }
  };

  return (
    <div className={styles.container}>
      <textarea
        className={styles.textarea}
        value={input}
        onChange={(e) => setInput(e.target.value)}
        onKeyDown={handleKeyDown}
        placeholder="输入消息..."
        disabled={isLoading}
        rows={1}
      />
      <button
        className={`${styles.button} ${isLoading ? styles.loading : ''}`}
        onClick={handleSend}
        disabled={isLoading || !input.trim()}
      >
        {isLoading ? '发送中...' : '发送'}
      </button>
    </div>
  );
}
```

### ChatInput.module.css
```css
.container {
  display: flex;
  gap: 12px;
  padding: 16px;
  background: #f5f5f5;
  border-top: 1px solid #e0e0e0;
}

.textarea {
  flex: 1;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
  resize: none;
  font-family: inherit;
  font-size: 14px;
  line-height: 1.5;
  min-height: 44px;
  max-height: 120px;
}

.textarea:focus {
  outline: none;
  border-color: #1890ff;
}

.textarea:disabled {
  background: #f0f0f0;
  cursor: not-allowed;
}

.button {
  padding: 12px 24px;
  background: #1890ff;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.2s;
}

.button:hover:not(:disabled) {
  background: #40a9ff;
}

.button:disabled {
  background: #d9d9d9;
  cursor: not-allowed;
}

.loading {
  opacity: 0.7;
}
```

## 改造后（Tailwind + daisyUI 版本）

### ChatInput.tsx
```typescript
import { useState } from 'react';

interface ChatInputProps {
  onSend: (message: string) => void;
  isLoading?: boolean;
}

export default function ChatInput({ onSend, isLoading }: ChatInputProps) {
  const [input, setInput] = useState('');

  const handleSend = () => {
    if (!input.trim() || isLoading) return;
    onSend(input);
    setInput('');
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSend();
    }
  };

  return (
    <div className="flex gap-3 p-4 bg-base-200 border-t border-base-300">
      <textarea
        className="textarea textarea-bordered flex-1 min-h-[44px] max-h-[120px] resize-none"
        value={input}
        onChange={(e) => setInput(e.target.value)}
        onKeyDown={handleKeyDown}
        placeholder="输入消息..."
        disabled={isLoading}
        rows={1}
      />
      <button
        className="btn btn-primary min-w-[80px]"
        onClick={handleSend}
        disabled={isLoading || !input.trim()}
      >
        {isLoading ? (
          <>
            <span className="loading loading-spinner loading-xs"></span>
            发送中
          </>
        ) : (
          '发送'
        )}
      </button>
    </div>
  );
}
```

### 删除文件
- `ChatInput.module.css`（不再需要）

## 类名对照表

| 原 CSS Modules | Tailwind + daisyUI | 说明 |
|----------------|-------------------|------|
| `display: flex` | `flex` | flex 布局 |
| `gap: 12px` | `gap-3` | 12px 间距（1单位=4px）|
| `padding: 16px` | `p-4` | 16px 内边距 |
| `flex: 1` | `flex-1` | 占据剩余空间 |
| `background: #f5f5f5` | `bg-base-200` | 次要背景色（自动适配主题）|
| `border-top: 1px solid #e0e0e0` | `border-t border-base-300` | 顶部边框（自动适配主题）|
| `padding: 12px 24px` | `btn` | daisyUI 按钮基础类 |
| `background: #1890ff` | `btn-primary` | 主题色按钮 |
| `border-radius: 8px` | `rounded-lg` 或组件自带 | 圆角 |
| `cursor: not-allowed` | 组件自动处理 | 禁用状态样式 |
| `resize: none` | `resize-none` | 禁止调整大小 |
| `min-height: 44px` | `min-h-[44px]` | 任意值使用方括号 |
| `max-height: 120px` | `max-h-[120px]` | 任意值使用方括号 |

## 常用 daisyUI 组件类名

### 按钮
```tsx
// 基础按钮
<button className="btn">默认</button>

// 主题色按钮
<button className="btn btn-primary">主要</button>

// 次要按钮
<button className="btn btn-secondary">次要</button>

// 幽灵按钮（透明背景）
<button className="btn btn-ghost">幽灵</button>

// 圆形按钮
<button className="btn btn-circle">+</button>

// 加载状态
<button className="btn btn-primary" disabled>
  <span className="loading loading-spinner"></span>
  加载中
</button>
```

### 输入框
```tsx
// 基础输入框
<input className="input" placeholder="提示" />

// 带边框输入框
<input className="input input-bordered" />

// 不同尺寸
<input className="input input-sm" />  // 小
<input className="input input-lg" />  // 大

// 多行文本
<textarea className="textarea textarea-bordered" />
```

### 卡片
```tsx
<div className="card bg-base-200 shadow-sm">
  <div className="card-body">
    <h2 className="card-title">标题</h2>
    <p>内容</p>
  </div>
</div>
```

### 聊天气泡（daisyUI 特有）
```tsx
// 对方消息（左侧）
<div className="chat chat-start">
  <div className="chat-header">用户名</div>
  <div className="chat-bubble">消息内容</div>
  <div className="chat-footer opacity-50">10:00</div>
</div>

// 我的消息（右侧）
<div className="chat chat-end">
  <div className="chat-bubble chat-bubble-primary">消息内容</div>
</div>
```

## Tailwind 常用工具类速查

### 布局
```
flex          → display: flex
grid          → display: grid
block         → display: block
hidden        → display: none

flex-1        → flex: 1
flex-none     → flex: none

gap-2         → gap: 0.5rem (8px)
gap-4         → gap: 1rem (16px)

justify-center    → justify-content: center
items-center      → align-items: center
```

### 间距
```
p-4           → padding: 1rem (16px)
px-4          → padding-left/right: 1rem
py-2          → padding-top/bottom: 0.5rem
pt-4          → padding-top: 1rem

m-4           → margin: 1rem
mx-auto       → margin-left/right: auto
mb-2          → margin-bottom: 0.5rem
```

### 尺寸
```
w-full        → width: 100%
w-64          → width: 16rem (256px)
w-[100px]     → width: 100px (任意值)

h-screen      → height: 100vh
min-h-[44px]  → min-height: 44px
max-w-md      → max-width: 28rem (448px)
```

### 背景与边框
```
bg-base-100       → 主背景色
text-base-content → 主文字色

rounded-lg        → border-radius: 0.5rem
rounded-full      → border-radius: 9999px

shadow-sm         → 小阴影
shadow-md         → 中阴影
```

## 原理解释

### 为什么用 Tailwind 替代 CSS Modules？

1. **开发效率**：不需要在 CSS 和 TSX 文件之间切换
2. **一致性**：使用设计系统的预定义值（如 gap-4 总是 16px）
3. **主题适配**：`bg-base-200` 在 cupcake 和 dark 主题下自动显示不同颜色
4. **体积优化**：生产环境只打包使用的类名

### daisyUI 与 Tailwind 的关系

- Tailwind 提供底层工具类（布局、间距、颜色）
- daisyUI 提供高层组件类（按钮、输入框、卡片）
- 两者可以混用：`className="btn btn-primary w-full mt-4"`

### 主题适配机制

```css
/* daisyUI 内部使用 CSS 变量 */
[data-theme="cupcake"] {
  --p: 183 47% 60%;      /* primary 色 */
  --pc: 0 0% 100%;       /* primary 上的文字 */
  --b1: 24 33% 97%;      /* base-100 背景 */
  --bc: 24 10% 10%;      /* base-content 文字 */
}

[data-theme="dark"] {
  --p: 262 80% 50%;
  --pc: 0 0% 100%;
  --b1: 220 14% 10%;
  --bc: 220 14% 90%;
}
```

使用 `bg-base-200` 时，实际应用的是 `--b2` 变量，不同主题值不同。

## 你的任务

1. **改造 ChatInput 组件**：
   - 用上面的改造后代码替换原 ChatInput.tsx
   - 删除 ChatInput.module.css
   - 验证样式和交互正常

2. **理解改造逻辑**：
   - 对照"类名对照表"理解每个类名的作用
   - 尝试修改一些类名，看看效果变化

3. **准备后续改造**：
   - 查看其他组件（MessageBubble、ChatList、ModeSelector）的 CSS Modules
   - 思考如何用 Tailwind + daisyUI 替代

完成后告诉我："我写好了，你检查一下 @apps/client/src/components/ChatInput/ChatInput.tsx"

注意：改造后如果看到样式错乱，可能是因为 index.css 还没配置好，先完成"安装配置案例"中的配置步骤。
